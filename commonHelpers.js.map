{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst BASE_URL = \"https://pixabay.com\";\nconst END_POINT = \"/api/\";\nconst API_KEY = \"44024733-f77ed4f0ed7e81c67856c8782\";\n\nexport async function getPosts(searchQuery, page = 1, perPage = 15) {\n\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n    });\n\n    const url = `${BASE_URL}${END_POINT}?${params}`;\n\n    try {\n        const response = await axios(url);\n        return response.data;\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: `Something went wrong. ${error.message}`\n        })\n    }\n\n};","\n\nexport function postTemplate(post) {\n    return `\n        <li class=\"gallery-item\">\n            <a href=\"${post.largeImageURL}\">\n                <img src=\"${post.webformatURL}\" alt=\"${post.tags}\" class=\"gallery-item-image\">\n                <div class=\"info\">\n                    <p class=\"info-title\">Likes:<span class=\"info-value\">${post.likes}</span></p>\n                    <p class=\"info-title\">Views:<span class=\"info-value\">${post.views}</span></p>\n                    <p class=\"info-title\">Comments:<span class=\"info-value\">${post.comments}</span></p>\n                    <p class=\"info-title\">Downloads:<span class=\"info-value\">${post.downloads}</span></p>\n                </div>\n            </a>\n        </li>\n    `\n};\n\nexport function postsTemplate(arr) {\n    return arr.map(postTemplate).join(\"\");\n};","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getPosts } from \"./js/pixabay-api\";\nimport { postsTemplate } from \"./js/render-function\";\n\nconst selectors = {\n    form: document.querySelector(\".search-form\"),\n    postsGallery: document.querySelector(\".gallery\"),\n    loader: document.querySelector(\".loader\"),\n    loadMoreBtn: document.querySelector(\".load-more\"),\n\n};\n\nselectors.loader.classList.add(\"hidden\");\nselectors.loadMoreBtn.classList.add(\"hidden\");\n\nlet page = 1;\nlet totalHits = 0;\nlet query = \"\";\n\n\nasync function handleSubmit(event) {\n\n    event.preventDefault();\n\n    query = event.target.elements.searchQuery.value.trim();\n\n    if (!query) {\n        iziToast.info({\n            title: \"No data\",\n            message: \"Please enter a search query\"\n        });\n\n        return;\n    }\n\n\n    selectors.postsGallery.innerHTML = \"\";\n    selectors.loader.classList.remove(\"hidden\");\n    \n    try {\n        \n        const data = await getPosts(query, page);\n        totalHits = data.totalHits;\n\n        if (totalHits === 0) {\n            iziToast.warning({\n                title: \"No result\",\n                message: \"Sorry, there are no images matching your search query. Please try again!\"\n            })\n        }\n\n        const markup = postsTemplate(data.hits);\n        selectors.postsGallery.insertAdjacentHTML(\"beforeend\", markup);\n        const lightbox = new SimpleLightbox(\".gallery a\");\n        lightbox.refresh();\n\n        if (totalHits > data.hits.length) {\n            selectors.loadMoreBtn.classList.remove(\"hidden\");\n        }\n\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: `Something went wrong. ${error.message}`\n        })\n    } finally {\n        selectors.loader.classList.add(\"hidden\");\n        event.target.reset();\n    }\n}\n\nselectors.form.addEventListener(\"submit\", handleSubmit);\n\n\n\n\nasync function handleLoadMore() {\n    \n    page += 1;\n    selectors.loader.classList.remove(\"hidden\");\n\n\n    try {\n        const data = await getPosts(query, page);\n        const markup = postsTemplate(data.hits);\n        selectors.postsGallery.insertAdjacentHTML(\"beforeend\", markup);\n        const lightbox = new SimpleLightbox(\".gallery a\");\n        lightbox.refresh();\n\n        const item = document.querySelector(\".gallery-item\");\n        const itemHeight = item.getBoundingClientRect().height;\n        window.scrollBy({\n            left: 0,\n            top: itemHeight * 2,\n            behavior: \"smooth\"\n        })\n\n        totalHits = data.totalHits;\n\n        if (totalHits <= page * 15) {\n            selectors.loadMoreBtn.classList.add(\"hidden\");\n            iziToast.info({\n                title: 'End of results',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: `Something went wrong. ${error.message}`\n        });\n    } finally {\n        selectors.loader.classList.add('hidden');\n    }\n\n}\n\nselectors.loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\n\n\n"],"names":["BASE_URL","END_POINT","API_KEY","getPosts","searchQuery","page","perPage","params","url","axios","error","iziToast","postTemplate","post","postsTemplate","arr","selectors","totalHits","query","handleSubmit","event","data","markup","SimpleLightbox","handleLoadMore","itemHeight"],"mappings":"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"}